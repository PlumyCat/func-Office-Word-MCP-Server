<mxfile host="65bd71144e">
    <diagram id="remote-mcp-architecture" name="MCP Server Solution Architecture">
        <mxGraphModel dx="1281" dy="706" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1100" pageHeight="850" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="client-container" value="MCP Clients" style="swimlane;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;startSize=30;fontSize=14;fontStyle=1;swimlaneFillColor=#F5F5F5;" parent="1" vertex="1">
                    <mxGeometry x="19" y="899" width="170" height="220" as="geometry"/>
                </mxCell>
                <mxCell id="vscode-client" value="VS Code &amp; Copilot" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" parent="client-container" vertex="1">
                    <mxGeometry x="20" y="50" width="130" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="mcp-inspector" value="MCP Inspector" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" parent="client-container" vertex="1">
                    <mxGeometry x="20" y="130" width="130" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="client-to-function" value="SSE Connection&#10;/runtime/webhooks/mcp/sse" style="endArrow=classic;html=1;rounded=0;fontSize=11;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="client-container" target="11" edge="1">
                    <mxGeometry x="0.153" y="25" width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="220" y="210" as="sourcePoint"/>
                        <mxPoint x="310" y="280" as="targetPoint"/>
                        <mxPoint y="-1" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="11" value="Azure Function App (Python 3.11)" style="swimlane;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;startSize=30;fontSize=14;fontStyle=1;swimlaneFillColor=#f5f5f5;" parent="1" vertex="1">
                    <mxGeometry x="370" y="55" width="451" height="1600" as="geometry"/>
                </mxCell>
                <mxCell id="12" value="MCP Tools" style="swimlane;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;startSize=30;" parent="11" vertex="1">
                    <mxGeometry x="10.5" y="50" width="430" height="1080" as="geometry"/>
                </mxCell>
                <mxCell id="18" value="SSE Endpoint&#10;/runtime/webhooks/mcp/sse" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;" parent="12" vertex="1">
                    <mxGeometry x="240" y="50" width="170" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="13" value="&lt;b&gt;hello_mcp&lt;/b&gt;&#10;Hello world tool" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;" parent="12" vertex="1">
                    <mxGeometry x="20" y="50" width="200" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="30" value="&lt;b&gt;Document&lt;/b&gt;&#10;word_create_document&#10;word_copy_document&#10;word_list_documents&#10;word_list_templates&#10;word_get_document_info&#10;word_get_document_outline&#10;word_get_text&#10;word_get_paragraph_text" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;fontSize=11;" parent="12" vertex="1">
                    <mxGeometry x="20" y="120" width="390" height="170" as="geometry"/>
                </mxCell>
                <mxCell id="31" value="&lt;b&gt;Contenu &amp; Styles&lt;/b&gt;&#10;word_add_paragraph&#10;word_add_heading&#10;word_add_page_break&#10;word_delete_paragraph&#10;word_find_text&#10;word_search_and_replace&#10;word_format_text&#10;word_create_custom_style&#10;word_add_comment" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;fontSize=11;" parent="12" vertex="1">
                    <mxGeometry x="20" y="300" width="390" height="180" as="geometry"/>
                </mxCell>
                <mxCell id="32" value="&lt;b&gt;Tableaux&lt;/b&gt;&#10;word_add_table, word_format_table&#10;word_format_table_cell_text&#10;word_set_table_cell_shading&#10;word_apply_table_alternating_rows&#10;word_highlight_table_header&#10;word_merge_table_cells (+ _horizontal/_vertical)&#10;word_set_table_cell_alignment&#10;word_set_table_alignment_all&#10;word_set_table_cell_padding&#10;word_set_table_column_width&#10;word_set_table_width&#10;word_auto_fit_table_columns" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;fontSize=11;" parent="12" vertex="1">
                    <mxGeometry x="20" y="490" width="390" height="250" as="geometry"/>
                </mxCell>
                <mxCell id="33" value="&lt;b&gt;Commentaires&lt;/b&gt;&#10;word_get_all_comments&#10;word_get_comments_by_author&#10;word_get_comments_for_paragraph" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;fontSize=11;" parent="12" vertex="1">
                    <mxGeometry x="20" y="750" width="390" height="110" as="geometry"/>
                </mxCell>
                <mxCell id="34" value="&lt;b&gt;Images&lt;/b&gt;&#10;word_add_picture" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;fontSize=11;" parent="12" vertex="1">
                    <mxGeometry x="20" y="870" width="390" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="35" value="&lt;b&gt;Total Tools:&lt;/b&gt; 37" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=12;fontStyle=1;" parent="12" vertex="1">
                    <mxGeometry x="20" y="940" width="390" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="http-api" value="HTTP API" style="swimlane;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;startSize=30;fontSize=14;fontStyle=1;swimlaneFillColor=#f5f5f5;" vertex="1" parent="11">
                    <mxGeometry x="20" y="1140" width="430" height="420" as="geometry"/>
                </mxCell>
                <mxCell id="api-ping" value="GET /api/ping" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;fontSize=11;" vertex="1" parent="http-api">
                    <mxGeometry x="20" y="40" width="180" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="api-init" value="POST /api/users/{userId}/init" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;fontSize=11;" vertex="1" parent="http-api">
                    <mxGeometry x="220" y="40" width="190" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="api-images" value="POST /api/users/{userId}/images\nGET /api/users/{userId}/images" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;fontSize=11;" vertex="1" parent="http-api">
                    <mxGeometry x="20" y="90" width="390" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="api-templates" value="POST /api/users/{userId}/templates\nGET /api/users/{userId}/templates\nGET /api/templates (shared)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;fontSize=11;" vertex="1" parent="http-api">
                    <mxGeometry x="20" y="160" width="390" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="api-convert" value="POST /api/convert/word-to-pdf" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;fontSize=11;" vertex="1" parent="http-api">
                    <mxGeometry x="20" y="245" width="390" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="api-mcp-exec" value="POST /api/mcp/exec (MCP dispatcher)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;fontSize=11;" vertex="1" parent="http-api">
                    <mxGeometry x="20" y="295" width="390" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="ms-graph" value="Microsoft Graph + SharePoint&#10;Drive: SP_DRIVE_ID / Site: SP_SITE_ID" style="swimlane;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;startSize=37;fontSize=12;" vertex="1" parent="1">
                    <mxGeometry x="840" y="1326" width="243" height="37" as="geometry"/>
                </mxCell>
                <mxCell id="client-to-http" value="HTTP requests" style="endArrow=classic;html=1;rounded=0;fontSize=11;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="client-container" target="http-api">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="api-to-blob" value="Store/List images &amp; templates, SAS URLs" style="endArrow=classic;html=1;rounded=0;fontSize=11;entryX=0.5;entryY=1;entryDx=0;entryDy=0;exitX=1;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" source="http-api" target="36">
                    <mxGeometry x="0.277" y="-44" relative="1" as="geometry">
                        <mxPoint x="933.348861283644" y="536" as="targetPoint"/>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="api-to-graph" value="Upload temp, convert to PDF, cleanup" style="endArrow=classic;html=1;rounded=0;fontSize=11;" edge="1" parent="1" target="ms-graph">
                    <mxGeometry x="0.6049" y="71" relative="1" as="geometry">
                        <mxPoint x="821" y="1217" as="sourcePoint"/>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="36" value="Azure Blob Storage&#10;container: stword&#10;prefixes:&#10;- userId/image_blob/&#10;- userId/templates/&#10;- shared/templates/" style="swimlane;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d79b00;startSize=100;fontSize=12;" vertex="1" parent="1">
                    <mxGeometry x="849" y="889" width="232" height="100" as="geometry">
                        <mxRectangle x="840" y="345" width="152" height="98" as="alternateBounds"/>
                    </mxGeometry>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>